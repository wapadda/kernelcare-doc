(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{198:function(e,a,t){"use strict";t.r(a);var s=t(0),r=Object(s.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"content"},[t("h1",{attrs:{id:"scanner-interface"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#scanner-interface","aria-hidden":"true"}},[e._v("#")]),e._v(" Scanner Interface")]),e._v(" "),t("h2",{attrs:{id:"issue-description"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#issue-description","aria-hidden":"true"}},[e._v("#")]),e._v(" Issue description")]),e._v(" "),t("p",[e._v("Commonly used security scanners can still see CVEs even if they are patched by KernelCare. It turns out that all their decisions about CVE are based on:")]),e._v(" "),t("ul",[t("li",[e._v("currently installed (or not) kernel packages")]),e._v(" "),t("li",[e._v("uname information")])]),e._v(" "),t("h2",{attrs:{id:"how-does-it-work"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#how-does-it-work","aria-hidden":"true"}},[e._v("#")]),e._v(" How does it work")]),e._v(" "),t("p",[e._v("To calm them down, we can manipulate with that information and the common part for DEB and RPM distributions relying on "),t("code",[e._v("uname -r")]),e._v(" output.")]),e._v(" "),t("p",[e._v("Since scanners on RPM distributions relies on "),t("code",[e._v("rpm -q")]),e._v(" output, we can override some functions there via "),t("code",[e._v("LD_PRELOAD")]),e._v(" and force the script to output versions we need.")]),e._v(" "),t("p",[e._v("To deal with it, we will reload "),t("code",[e._v("showQueryPackage")]),e._v(" to patch version information on the fly. It will change the information showing in rpm query results like this.")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("[centos@ip-172-31-6-166 ~]$ rpm -q kernel-headers\nkernel-headers-3.10.0-693.17.1.el7.x86_64\n[centos@ip-172-31-6-166 ~]$ LD_PRELOAD=/usr/libexec/kcare/kpatch_package.so rpm -q\nkernel-headers-3.10.0-957.21.3.el7.x86_64\n")])])]),t("p",[e._v("The reloaded functions rely on "),t("code",[e._v("kcarectl --uname")]),e._v(" and replace the actual kernel version with our “effective version”.\nThat behavior is enabled only for one user and will not interfere with others. That user should be used to run a credentialed scan over SSH.")]),e._v(" "),t("h2",{attrs:{id:"installation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#installation","aria-hidden":"true"}},[e._v("#")]),e._v(" Installation")]),e._v(" "),t("p",[e._v("All you need to do on target systems is to install/update KernelCare agent with the provided package.")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("KCARE_SCANNER_USER=username yum -y localinstall ./kernelcare-package.rpm\n")])])]),t("p",[e._v("Or update an existing package:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("KCARE_SCANNER_USER=username yum update kernelcare\n")])])]),t("p",[e._v("Or install:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("curl -s -L https://kernelcare.com/installer | KCARE_SCANNER_USER=username bash\n")])])]),t("p",[e._v("Where "),t("code",[e._v("username")]),e._v(" is the user which will be used to run scanners on the server.\nAfter applying KernelCare patches ("),t("code",[e._v("kcarectl --update")]),e._v(") you will see rpm query result according to a kernel that the patches are provided.")]),e._v(" "),t("div",{staticClass:"tip custom-block"},[t("p",{staticClass:"custom-block-title"},[e._v("Note")]),e._v(" "),t("p",[e._v("To see results, you should re-login to the server with "),t("code",[e._v("KCARE_SCANNER_USER")]),e._v(" defined above.")])]),e._v(" "),t("h2",{attrs:{id:"how-to-use"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#how-to-use","aria-hidden":"true"}},[e._v("#")]),e._v(" How to use")]),e._v(" "),t("p",[e._v("It’s rather simple. New scan results after installing a package and applying a patchset should not show any kernel CVEs that are handled by KernelCare.")]),e._v(" "),t("p",[e._v("For example, Nessus for an old kernel shows a bunch of detected CVEs")]),e._v(" "),t("p",[t("img",{attrs:{src:"/images/scanner-manipulation-before.png",alt:""}})]),e._v(" "),t("p",[e._v("After patches were applied, there are no kernel-related CVEs")]),e._v(" "),t("p",[t("img",{attrs:{src:"/images/scanner-manipulation-after.png",alt:""}})])])}],!1,null,null,null);a.default=r.exports}}]);